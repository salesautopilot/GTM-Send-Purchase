___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "SalesAutopilot - send purchase event",
  "categories": ["CONVERSIONS", "EMAIL_MARKETING"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "SalesAutopilot",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABJ0AAASdAHeZh94AAAAB3RJTUUH5wEKERI42FpJRAAABeNJREFUaIHtmFlsVFUYx393n4Vpx660pYuUgrQKpBUUpSompqgoMcjig8YYTdAXE0yMMb75gA+uMb6oL+qLoogaIxpBo0RcqO2AotTSAh3oTtdZ7ix3rg/D0su9nWk1OjTp/2nyP9899/8/9zvfd84IN+78yGQOQ8y1gH+LeQO5xryBXGNOGdhS08kbN35LS8VpRCFdPOeMgVJ3mE1V3fjVOJsquynUdGAOGSjUdITzvzXJQBEMYA4ZmA5yrgVMB00yWFvch1tOIgCl7sjFMUkwuWXhWSYS2pVrYHP1Ce5edMpxTBFT3FOZHrsiU0gAPFJiRrFXpAET2He2hiHdjW7I6IZMPCVZYmKGhG7ICP/XabS80EtjbTGlfjcuVSKWSDE0HiXQPUzP4CROIhQxhSamq82y/BF2NgQA0A2JXUevpz/q/Wd7QJVFCn0uWpqqWFdfRonfzfPvt3L4r0FLnCgKLCr08sTG61hXX4YkCra5kkaK9q5h3vj8N/7qHcOc4iSREkmk0kkSNaxSI0mZUFKZvYGVi4t4cP1SVi0uwutSLvKKZM1GRRZ58PZlbFlXi9+rTTufLImsXlrCazua2Xf4NG999QeRWNIWF5tiIIWAeb4rzNiAIAhsaKrk6c2NuFQpY6yqSDx+VwNbm5cgCvZVd0K+R2X7rXX4PCq7dv+KkbIm1amQj5GYRr4ap3sin9G4NjsDD9xax2Mb6nEpmcULAmxrXjIr8VOxoamKyUic1z47auENU+T5I2sod4cJRnzo57/IjAzUlft56PZlNvGmaTISinFuQmciki57hT4X2xzEJ5IpTg5MEOgepnckTFGem1WLi6gty8OtXpIhiQKbb67l4LE+2rqGLHMM6h4GdY+Fm5GBHXc1kO9VbfyeQ93s/v4Ew5M6ejydt4+21FOY57KJf2lvgAOBM4T0S/XdpUo0N5Tz3PYmVPnS4iiyyIamKpsBJ2TtA3kelZuWL7RwRsrk3QMdvLL3CMHhENFYEtMEv1ejpbHKFvvml8f49KeTFvEAetzg6/Ygu3a3kTBSlrH1KysQHarWrA20NFbauOPBUd45cJyUad1o11YX2Db4uUmdrwNnMr7jq7Ygv3QMWDivplBT4ssmL7uBunK/jTs5MEE0bi91JX63jRsci3JuQs/4DtM06ewdt3CCAGuvWTjNE5eQ1YAs2T/jWDiO6dA6Zck+XSiawLgsPZygOyzIwgKPQ6QVWQ14pjSrC0gkDcfYeMLOF+ZpaFn6BuDY7PLc9sJxOTIakCURn9tuoH804hANvSNhG1fq97CoaEFGEZIocHN9mY1fWuEnWyvJaGB1XQkNVQU2vq1r2DH+WM8oY+G4hcvzqDxyx3I8mnPF9mgyz2xppLLYbrKswMOapaWZJE5vYNXiIl569Ca0y5pX30iY3nP2lQYI6wn2/NBl49evqOD1Hc0UXdYf3KrMs9ua2LimxnE+TZF44eG1lF01/V6wHKe9LoX719VSXezjthXllg4JEE8aPPX2IVo7B20TXcACl8LbT66n2qEERmJJ2ruGGJmM4fMoNC0pxjeDPI/EkuwPBOk4M8bBY30MjUcvjlkU5ntVdtzZMO1E3//eR3uW7hjSE7z3TQfPbm2yNSKPJjvm+lSYJra892gy995wNdwAY6EY3xw9e3FsRjcy04QvWk/zwodttlOiE75o7eGVT444Hoszv8fkg4Od/HR8wPGC44SMZyETiOgJ9rX28OqnR2Yk/oKQj37oYiwcZ+d9K/F7VYQM5cQkvbIv7w2wP3AGURR46r5V3L262rYHsxowzbSAofEoew518+Of/ZzoG3d6Niv2B4IcPTVMc0M5229ZQlmB13IrS5km/aMR3v+uk587BugZCqX5lMmLHwfY3x7kthUVbFxTg0uVHI/nlk2sSCIlfjf9o5EZr/ZsoCkSV5fmUeDTGA/H6eqfcOzATvAv0Kgrzyc4FLL0of/tUv9f4Yr8W2U2mDeQa8wbyDXmDeQa8wZyjXkDucacN/A3nPsRR+cVdVIAAAAASUVORK5CYII\u003d"
  },
  "description": "If you use Google Analytics, SalesAutopilot can link the amount of purchases measured by Analytics to the letter from which the visitor arrived at your website before the purchase.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const copyFromDataLayer = require('copyFromDataLayer');
const localStorage = require('localStorage');
const sendPixel = require('sendPixel');

const url = "https://ec.salesautopilot.com?utm_campaign=" + localStorage.getItem('utm_campaign') + "&utm_source=" + localStorage.getItem('utm_source') + "&utm_medium=" + localStorage.getItem('utm_medium') + "&total=" + copyFromDataLayer('value') + "&currency=" + copyFromDataLayer('currency');
sendPixel(url, data.gtmOnSuccess(), data.gtmOnFailure());


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_local_storage",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "utm_campaign"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "utm_source"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "utm_medium"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "value"
              },
              {
                "type": 1,
                "string": "currency"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://ec.salesautopilot.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: First
  code: |-
    let variableResult = runCode({});
    assertThat(variableResult).isEqualTo(undefined);
setup: ''


___NOTES___

Created on 2023. 01. 08. 22:27:05


